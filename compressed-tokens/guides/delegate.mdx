---
title: Approve and Revoke Delegate Authority
description: "Grant and remove delegate spending authority for compressed tokens with approve() and revoke(). Only the token owner can perform these operations."
keywords: ["delegate authority on solana", "token delegation compressed"]
---

import FullSetup from "/snippets/setup/full-setup.mdx";
import ApproveActionCode from '/snippets/code-snippets/compressed-token/approve/action.mdx';
import RevokeActionCode from '/snippets/code-snippets/compressed-token/revoke/action.mdx';

The `approve()` and `revoke()` functions grant and remove delegate spending authority for compressed tokens. Only the token owner can perform these instructions.

<CodeGroup>
```typescript approve()
// Approve delegate for spending up to the specified amount
const approveSignature = await approve(
    rpc,
    payer,
    mint, // SPL mint with SPL interface for compression
    amount,
    owner,
    delegate.publicKey, // delegate account
);
```

```typescript revoke()
// Get delegated accounts for revocation
const delegatedAccounts = await rpc.getCompressedTokenAccountsByDelegate(
    delegate.publicKey,
    { mint }
);

// Revoke delegate authority
const revokeSignature = await revoke(
    rpc,
    payer,
    delegatedAccounts.items, // delegated compressed token accounts
    owner,
);
```
</CodeGroup>

## Get Started

<Steps>
<Step>
### Approve / Revoke Delegates

<FullSetup />

<Tabs>
<Tab title="Approve">
<ApproveActionCode />
</Tab>
<Tab title="Revoke">
<RevokeActionCode />
</Tab>
</Tabs>

<Info>
Before we approve or revoke delegates, we need:

* compressed token accounts to delegate or revoke delegation from, and
* an SPL mint with an SPL interface. Create one for new mints via [`createMint()`](/compressed-tokens/guides/create-mint-with-token-pool) or for existing mints via [`createSplInterface()`](/compressed-tokens/guides/add-token-pools-to-mint-accounts).
</Info>

</Step>
</Steps>

# Troubleshooting

<AccordionGroup>
<Accordion title="Account is not delegated">

Attempting to revoke non-delegated accounts.

```typescript
/// Verify accounts are delegated before revocation.
const delegateAccounts = await rpc.getCompressedTokenAccountsByDelegate(
    delegate.publicKey,
    { mint }
);

if (delegateAccounts.items.length === 0) {
    console.log("No delegated accounts to revoke");
    return;
}
```

</Accordion>
</AccordionGroup>

# Advanced Configuration

<AccordionGroup>
<Accordion title="Approve Multiple Delegates">

```typescript
const delegates = [
    Keypair.generate().publicKey,
    Keypair.generate().publicKey,
];

const amounts = [
    200_000_000, // 0.2 tokens to first delegate
    300_000_000, // 0.3 tokens to second delegate
];

// Approve each delegate
for (let i = 0; i < delegates.length; i++) {
    const approveTx = await approve(
        rpc,
        payer,
        mint,
        amounts[i],
        tokenOwner,
        delegates[i],
    );

    console.log(`Delegate ${i + 1} approved:`, approveTx);
}
```

</Accordion>

<Accordion title="Revoke Multiple Delegates">

```typescript
const delegates = [
    new PublicKey("DELEGATE_1_ADDRESS"),
    new PublicKey("DELEGATE_2_ADDRESS"),
];

// Revoke each delegate
for (const delegate of delegates) {
    // Get delegated accounts for this delegate
    const delegateAccounts = await rpc.getCompressedTokenAccountsByDelegate(
        delegate,
        { mint }
    );

    if (delegateAccounts.items.length > 0) {
        const revokeTx = await revoke(
            rpc,
            payer,
            delegateAccounts.items,
            tokenOwner,
        );

        console.log(`Delegate ${delegate.toBase58()} revoked:`, revokeTx);
    }
}
```

</Accordion>
</AccordionGroup>

# Next Steps

<Card
  title="Check out the advanced guides for airdrops, combining multiple instructions in one transaction, and client examples."
  icon="chevron-right"
  color="#0066ff"
  href="/compressed-tokens/advanced-guides"
  horizontal
/>
