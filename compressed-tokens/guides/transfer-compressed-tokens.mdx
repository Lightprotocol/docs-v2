---
title: Transfer Compressed Tokens
description: "Transfer compressed tokens between accounts. Transfers consume input accounts and create new output accounts with updated balances."
keywords: ["transfer compressed tokens", "token transfer on solana"]
---

import FullSetup from "/snippets/setup/full-setup.mdx";
import MintPrereq from '/snippets/setup/compressed-tokens-mint-prereq.mdx';
import ActionCode from '/snippets/code-snippets/compressed-token/transfer/action.mdx';

The `transfer()` function moves compressed tokens between accounts. 
* SPL token transfers that update the existing account
* Compressed token transfers consume input accounts from the sender and create new output accounts for sender and recipient with updated balances.
<Tip>
SPL token accounts can be compressed in the same transaction with `compress_or_decompress_amount`, if needed.
</Tip>


```typescript function-transfer-compressed-tokens.ts
// Transfer compressed tokens
const transactionSignature = await transfer(
    rpc,
    payer,
    mint, // SPL mint with token pool for compression
    amount,
    payer,
    recipient, // destination address (toAddress parameter)
)
```

## Get Started

<Steps>
<Step>
### Transfer Compressed Tokens

<FullSetup />

<ActionCode />
<MintPrereq />

</Step>
</Steps>

# Troubleshooting

<AccordionGroup>
<Accordion title="Insufficient balance for transfer">

The sender doesn't have enough compressed tokens for the requested transfer amount.

```typescript
// Check current balance first
const tokenAccounts = await rpc.getCompressedTokenAccountsByOwner(
    owner.publicKey,
    { mint }
);

if (tokenAccounts.items.length === 0) {
    throw new Error("No compressed token accounts found");
}

// Calculate total balance across all accounts
const totalBalance = tokenAccounts.items.reduce(
    (sum, account) => sum.add(account.parsed.amount),
    new BN(0)
);

console.log("Available balance:", totalBalance.toString());

// Ensure transfer amount doesn't exceed balance
if (new BN(transferAmount).gt(totalBalance)) {
    throw new Error(`Transfer amount ${transferAmount} exceeds balance ${totalBalance.toString()}`);
}
```

</Accordion>

<Accordion title="Account limit exceeded">

The transfer requires more than 4 compressed accounts, which exceeds the transaction limit.

```typescript
// Error message: "Account limit exceeded: max X (4 accounts) per transaction.
// Total balance: Y (Z accounts). Consider multiple transfers to spend full balance."

// Split into multiple smaller transfers
const maxTransferPerTx = 1_000_000_000; // Adjust based on your account sizes

if (transferAmount > maxTransferPerTx) {
    console.log("Large transfer detected, splitting into multiple transactions...");

    let remainingAmount = transferAmount;
    while (remainingAmount > 0) {
        const currentTransfer = Math.min(remainingAmount, maxTransferPerTx);

        await transfer(
            rpc,
            payer,
            mint,
            currentTransfer,
            owner,
            recipient
        );

        remainingAmount -= currentTransfer;
        console.log(`Transferred ${currentTransfer}, remaining: ${remainingAmount}`);
    }
}
```

</Accordion>
</AccordionGroup>

# Advanced Configuration

<AccordionGroup>
<Accordion title="Transfer to Multiple Recipients">

Transfer to multiple recipients in separate transactions:

```typescript
const recipients = [
    Keypair.generate().publicKey,
    Keypair.generate().publicKey,
    Keypair.generate().publicKey,
];

const amounts = [
    100_000_000, // 0.1 tokens
    200_000_000, // 0.2 tokens
    150_000_000, // 0.15 tokens
];

for (let i = 0; i < recipients.length; i++) {
    const transactionSignature = await transfer(
        rpc,
        payer,
        mint,
        amounts[i],
        owner,
        recipients[i],
    );

    console.log(`Transfer ${i + 1} completed:`, transactionSignature);
}
```

</Accordion>

<Accordion title="Transfer with Delegate Authority">

Transfer tokens using delegate authority:

```typescript
import { approve, transferDelegated } from '@lightprotocol/compressed-token';

// 1. Owner approves delegate
await approve(
    rpc,
    payer,
    mint,
    amount,
    owner, // Signer
    delegate.publicKey, // PublicKey
);

// 2. Delegate transfers tokens
await transferDelegated(
    rpc,
    payer,
    mint,
    transferAmount,
    delegate, // Signer - named "owner" in SDK
    recipient,
);
```

</Accordion>
</AccordionGroup>

# Next Steps

<Card
  title="How to Compress and Decompress SPL Tokens"
  icon="chevron-right"
  color="#0066ff"
  href="/compressed-tokens/guides/compress-decompress"
  horizontal
/>
