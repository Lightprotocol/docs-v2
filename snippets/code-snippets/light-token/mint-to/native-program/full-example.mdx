<CodeGroup>
```rust instruction.rs
use super::authority_seeds;
use light_token::instruction::MintToCpi;
use solana_program::{
    account_info::AccountInfo, entrypoint::ProgramResult,
    program_error::ProgramError,
};

pub fn mint_to_invoke(accounts: &[AccountInfo], data: &[u8]) -> ProgramResult {
    let [mint, destination, authority, system_program, _token_program] =
        accounts
    else {
        return Err(ProgramError::NotEnoughAccountKeys);
    };

    let amount = u64::from_le_bytes(
        data.try_into()
            .map_err(|_| ProgramError::InvalidInstructionData)?,
    );

    // Mint tokens to destination account
    MintToCpi {
        mint: mint.clone(),
        destination: destination.clone(),
        amount,
        authority: authority.clone(),
        system_program: system_program.clone(),
        fee_payer: None,
        max_top_up: None,
    }
    .invoke()
}

pub fn mint_to_invoke_signed(
    accounts: &[AccountInfo],
    data: &[u8],
) -> ProgramResult {
    let [mint, destination, authority, system_program, _token_program] =
        accounts
    else {
        return Err(ProgramError::NotEnoughAccountKeys);
    };

    if data.len() < 9 {
        return Err(ProgramError::InvalidInstructionData);
    }

    let amount = u64::from_le_bytes(data[0..8].try_into().unwrap());
    let bump = data[8];
    let signer_seeds = authority_seeds!(bump);

    MintToCpi {
        mint: mint.clone(),
        destination: destination.clone(),
        amount,
        authority: authority.clone(),
        system_program: system_program.clone(),
        fee_payer: None,
        max_top_up: None,
    }
    .invoke_signed(&[signer_seeds])
}
```

```rust test.rs
mod shared;

use light_client::rpc::Rpc;
use light_token::instruction::derive_token_ata;
use shared::{
    build_create_ata_signed_cpi_ix, build_mint_to_cpi_ix,
    build_mint_to_signed_cpi_ix, create_ata, create_test_rpc,
    get_authority_pda, setup_empty_ata, setup_mint_with_pda_authority,
    SetupContext,
};
use solana_sdk::signer::Signer;

#[tokio::test(flavor = "multi_thread")]
async fn mint_to_cpi() {
    // Setup: create mint and empty ATA
    let SetupContext {
        mut rpc,
        payer,
        mint,
        ata,
        ..
    } = setup_empty_ata().await;

    let amount = 1_000_000u64;

    let ix = build_mint_to_cpi_ix(mint, ata, payer.pubkey(), amount);

    rpc.create_and_send_transaction(&[ix], &payer.pubkey(), &[&payer])
        .await
        .unwrap();
}

/// Mints tokens via CPI with PDA authority.
#[tokio::test(flavor = "multi_thread")]
async fn mint_to_signed_cpi() {
    let mut rpc = create_test_rpc().await;
    let payer = rpc.get_payer().insecure_clone();

    let (pda_authority, authority_bump) = get_authority_pda();
    let decimals = 9u8;

    // Create mint with PDA authority
    let mint = setup_mint_with_pda_authority(
        &mut rpc,
        &payer,
        pda_authority,
        decimals,
    )
    .await;

    // Create ATA for the payer
    let ata = create_ata(&mut rpc, &payer, payer.pubkey(), mint).await;

    // Mint tokens using signed CPI
    let amount = 1_000_000u64;
    let mint_to_ix = build_mint_to_signed_cpi_ix(
        mint,
        ata,
        pda_authority,
        amount,
        authority_bump,
    );

    rpc.create_and_send_transaction(&[mint_to_ix], &payer.pubkey(), &[&payer])
        .await
        .unwrap();
}

/// Mints tokens using CPI-style ATA creation.
#[tokio::test(flavor = "multi_thread")]
async fn mint_to_signed_cpi_with_ata_cpi() {
    let mut rpc = create_test_rpc().await;
    let payer = rpc.get_payer().insecure_clone();

    let (pda_authority, authority_bump) = get_authority_pda();
    let decimals = 9u8;

    // Create mint with PDA authority
    let mint = setup_mint_with_pda_authority(
        &mut rpc,
        &payer,
        pda_authority,
        decimals,
    )
    .await;

    // Create ATA using the signed CPI instruction
    let (ata, ata_bump) = derive_token_ata(&payer.pubkey(), &mint);
    let create_ata_ix = build_create_ata_signed_cpi_ix(
        payer.pubkey(),
        mint,
        payer.pubkey(),
        ata,
        ata_bump,
        authority_bump,
    );

    rpc.create_and_send_transaction(
        &[create_ata_ix],
        &payer.pubkey(),
        &[&payer],
    )
    .await
    .unwrap();

    // Mint tokens using signed CPI
    let amount = 1_000_000u64;
    let mint_to_ix = build_mint_to_signed_cpi_ix(
        mint,
        ata,
        pda_authority,
        amount,
        authority_bump,
    );

    rpc.create_and_send_transaction(&[mint_to_ix], &payer.pubkey(), &[&payer])
        .await
        .unwrap();
}
```
</CodeGroup>
