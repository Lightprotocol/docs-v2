---
title: "c-Token Toolkit for Stablecoin Payments"
sidebarTitle: "for Stablecoin Payments"
description: "Guide to integrate c-Token APIs with comparison to SPL."
---

import { CodeCompare } from '/snippets/jsx/code-compare.jsx';

1. c-Token follows the same API patterns like ATA
2. Your users receives the same stablecoin, just stored more efficiently.

|  Creation Cost         | SPL  | c-Token      |
|:---------------------|:------------------|:----------------------|
| **Token Account**   | 	  ~2,000,000 lamports         | ~**17,000** lamports     |

<Info>
Get an [overview to c-Token's here](/c-token-program/README).
</Info>
### What you will implement

<table>
  <thead>
    <tr>
      <th style={{width: '15%'}}></th>
      <th>c-token</th>
      <th>SPL Token</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>**Get/Create ATA**</td>
      <td>getOrCreateAtaInterface()</td>
      <td>getOrCreateAssociatedTokenAccount()</td>
    </tr>
    <tr>
      <td>**Derive ATA**</td>
      <td>getAssociatedTokenAddressInterface()</td>
      <td>getAssociatedTokenAddress()</td>
    </tr>
    <tr>
      <td>**Transfer**</td>
      <td>transferInterface()</td>
      <td>transferChecked()</td>
    </tr>
    <tr>
      <td>**Get Balance**</td>
      <td>getAtaInterface()</td>
      <td>getAccount()</td>
    </tr>
    <tr>
      <td>**Tx History**</td>
      <td>rpc.getSignaturesForOwnerInterface()</td>
      <td>getSignaturesForAddress()</td>
    </tr>
    <tr>
      <td>**Exit to SPL**</td>
      <td>unwrap()</td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>

<Note>
Find devnet examples here [https://github.com/Lightprotocol/c-token-toolkit](https://github.com/Lightprotocol/c-token-toolkit).
</Note>

## Setup


Connect to an RPC endpoint that serves both standard Solana methods and compression methods.
```typescript
import { createRpc } from "@lightprotocol/stateless.js";

import {
  getOrCreateAtaInterface,
  getAtaInterface,
  getAssociatedTokenAddressInterface,
  transferInterface,
  unwrap,
} from "@lightprotocol/compressed-token/unified";

const rpc = createRpc(RPC_ENDPOINT);
```

<CodeCompare
  firstCode={`import { getOrCreateAtaInterface } from "@lightprotocol/compressed-token/unified";

const ata = await getOrCreateAtaInterface(
  rpc,
  payer,
  mint,
  recipient
);

console.log(ata.parsed.amount);`}
  secondCode={`import { getOrCreateAssociatedTokenAccount } from "@solana/spl-token";

const ata = await getOrCreateAssociatedTokenAccount(
  rpc,
  payer,
  mint,
  recipient
);

console.log(ata.amount);`}
  firstLabel="c-Token"
  secondLabel="SPL"
/>

<Steps>

<Step>
### Receive Payments

<Tabs>
<Tab title="Action">

```typescript
import { getOrCreateAtaInterface } from "@lightprotocol/compressed-token/unified";

const ata = await getOrCreateAtaInterface(
  rpc,
  payer,
  mint,
  recipient
);
// Share ata.parsed.address with sender

console.log(ata.parsed.amount);
```

<Accordion title="Compare to SPL">

```typescript
import { getOrCreateAssociatedTokenAccount } from "@solana/spl-token";

const ata = await getOrCreateAssociatedTokenAccount(
  connection,
  payer,
  mint,
  recipient
);
// Share ata.address with sender

console.log(ata.amount);
```

</Accordion>

</Tab>
<Tab title="Instruction">
```typescript
import {
  createAssociatedTokenAccountInterfaceIdempotentInstruction,
  createLoadAtaInstructions,
  getAssociatedTokenAddressInterface,
} from "@lightprotocol/compressed-token/unified";
import { CTOKEN_PROGRAM_ID } from "@lightprotocol/stateless.js";

const ata = getAssociatedTokenAddressInterface(mint, recipient);

const tx = new Transaction().add(
  createAssociatedTokenAccountInterfaceIdempotentInstruction(
    payer.publicKey,
    ata,
    recipient,
    mint,
    CTOKEN_PROGRAM_ID
  ),
  ...(await createLoadAtaInstructions(
    rpc,
    ata,
    recipient,
    mint,
    payer.publicKey
  ))
);
```

<Accordion title="Compare to SPL">

```typescript
import {
  createAssociatedTokenAccountInstruction,
  getAssociatedTokenAddressSync,
} from "@solana/spl-token";

const ata = getAssociatedTokenAddressSync(mint, recipient);

const tx = new Transaction().add(
  createAssociatedTokenAccountInstruction(
    payer.publicKey,
    ata,
    recipient,
    mint
  )
);
```

</Accordion>
</Tab>
</Tabs>

</Step>

<Step>
### Send Payments

<Tabs>
<Tab title="Action">

```typescript
import {
  getAssociatedTokenAddressInterface,
  transferInterface,
} from "@lightprotocol/compressed-token/unified";

const sourceAta = getAssociatedTokenAddressInterface(mint, owner.publicKey);
const destinationAta = getAssociatedTokenAddressInterface(mint, recipient);

await transferInterface(
  rpc,
  payer,
  sourceAta,
  mint,
  destinationAta,
  owner,
  amount
);
```

To ensure your recipient's ATA exists you can prepend an idempotent creation instruction in the same atomic transaction:

```typescript
import {
  getAssociatedTokenAddressInterface,
  createAssociatedTokenAccountInterfaceIdempotentInstruction,
} from "@lightprotocol/compressed-token/unified";
import { CTOKEN_PROGRAM_ID } from "@lightprotocol/stateless.js";

const destinationAta = getAssociatedTokenAddressInterface(mint, recipient);
const createAtaIx = createAssociatedTokenAccountInterfaceIdempotentInstruction(
  payer.publicKey,
  destinationAta,
  recipient,
  mint,
  CTOKEN_PROGRAM_ID
);

new Transaction().add(createAtaIx, transferIx);
```

<Accordion title="Compare to SPL">

```typescript
import { transfer } from "@solana/spl-token";

const sourceAta = getAssociatedTokenAddressSync(mint, owner.publicKey);
const destinationAta = getAssociatedTokenAddressSync(mint, recipient);

await transfer(
  connection,
  payer,
  sourceAta,
  destinationAta,
  owner,
  amount,
  decimals
);
```

With idempotent ATA creation:

```typescript
import {
  getAssociatedTokenAddressSync,
  createAssociatedTokenAccountIdempotentInstruction,
} from "@solana/spl-token";

const destinationAta = getAssociatedTokenAddressSync(mint, recipient);
const createAtaIx = createAssociatedTokenAccountIdempotentInstruction(
  payer.publicKey,
  destinationAta,
  recipient,
  mint
);

new Transaction().add(createAtaIx, transferIx);
```

</Accordion>

</Tab>
<Tab title="Instruction">

```typescript
import {
  createLoadAtaInstructions,
  createTransferInterfaceInstruction,
  getAssociatedTokenAddressInterface,
} from "@lightprotocol/compressed-token/unified";

const sourceAta = getAssociatedTokenAddressInterface(mint, owner.publicKey);
const destinationAta = getAssociatedTokenAddressInterface(mint, recipient);

const tx = new Transaction().add(
  ...(await createLoadAtaInstructions(
    rpc,
    sourceAta,
    owner.publicKey,
    mint,
    payer.publicKey
  )),
  createTransferInterfaceInstruction(
    sourceAta,
    destinationAta,
    owner.publicKey,
    amount
  )
);
```

<Accordion title="Compare to SPL">

```typescript
import {
  getAssociatedTokenAddressSync,
  createTransferInstruction,
} from "@solana/spl-token";

const sourceAta = getAssociatedTokenAddressSync(mint, owner.publicKey);
const destinationAta = getAssociatedTokenAddressSync(mint, recipient);

const tx = new Transaction().add(
  createTransferInstruction(sourceAta, destinationAta, owner.publicKey, amount)
);
```

</Accordion>

</Tab>
</Tabs>

</Step>

<Step>
### Show Balance

```typescript
import {
  getAssociatedTokenAddressInterface,
  getAtaInterface,
} from "@lightprotocol/compressed-token/unified";

const ata = getAssociatedTokenAddressInterface(mint, owner);
const account = await getAtaInterface(
  rpc,
  ata,
  owner,
  mint
);

console.log(account.parsed.amount);
```

<Accordion title="Compare to SPL">

```typescript
import { getAccount } from "@solana/spl-token";

const account = await getAccount(connection, ata);

console.log(account.amount);
```

</Accordion>

</Step>

<Step>
### Transaction History

```typescript
const result = await rpc.getSignaturesForOwnerInterface(owner);

console.log(result.signatures); // Merged + deduplicated
console.log(result.solana); // On-chain txs only
console.log(result.compressed); // Compressed txs only
```

Use `getSignaturesForAddressInterface(address)` if you want address-specific rather than owner-wide history.

<Accordion title="Compare to SPL">

```typescript
const signatures = await connection.getSignaturesForAddress(ata);
```

</Accordion>

</Step>

<Step>
### Unwrap to SPL

When users need vanilla SPL tokens (CEX withdrawal, legacy integration):

<Tabs>
<Tab title="Action">

```typescript
import { getAssociatedTokenAddressSync } from "@solana/spl-token";

// SPL ATA must exist
const splAta = getAssociatedTokenAddressSync(mint, owner.publicKey);

await unwrap(
  rpc,
  payer,
  owner,
  mint,
  splAta,
  amount
);
```

</Tab>
<Tab title="Instruction">

```typescript
import { getAssociatedTokenAddressSync } from "@solana/spl-token";
import {
  createLoadAtaInstructions,
  createUnwrapInstruction,
  getAssociatedTokenAddressInterface,
} from "@lightprotocol/compressed-token/unified";
import { getSplInterfaceInfos } from "@lightprotocol/compressed-token";

const ctokenAta = getAssociatedTokenAddressInterface(mint, owner.publicKey);
const splAta = getAssociatedTokenAddressSync(mint, owner.publicKey);

const splInterfaceInfos = await getSplInterfaceInfos(rpc, mint);
const splInterfaceInfo = splInterfaceInfos.find((i) => i.isInitialized);

const tx = new Transaction().add(
  ...(await createLoadAtaInstructions(
    rpc,
    ctokenAta,
    owner.publicKey,
    mint,
    payer.publicKey
  )),
  createUnwrapInstruction(
    ctokenAta,
    splAta,
    owner.publicKey,
    mint,
    amount,
    splInterfaceInfo
  )
);
```

</Tab>
</Tabs>

</Step>

</Steps>
