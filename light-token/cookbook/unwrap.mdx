---
title: Unwrap c-token to SPL/T22
sidebarTitle: Unwrap
description: Convert c-token hot balance back to SPL or Token-2022 tokens
---

import CTokenTsClientPrerequisites from '/snippets/light-token-guides/light-token-ts-client-prerequisites.mdx';

Unwrap moves tokens from a c-token ATA (hot balance) to an SPL/T22 token account.

<Info>
Find the source code [here](https://github.com/Lightprotocol/light-protocol/blob/main/js/compressed-token/tests/e2e/unwrap.test.ts).
</Info>

<Note>
The destination SPL/T22 account must exist before unwrapping. The action auto-loads compressed tokens to hot balance if needed.
</Note>

## Prerequisites

<CTokenTsClientPrerequisites />

## Usage

<CodeGroup>
```typescript Action
import { Keypair } from '@solana/web3.js';
import { createRpc } from '@lightprotocol/stateless.js';
import {
    createMint,
    mintTo,
    unwrap,
    getAssociatedTokenAddressInterface,
} from '@lightprotocol/compressed-token';
import { createAssociatedTokenAccount } from '@solana/spl-token';

async function main() {
    const rpc = createRpc();
    const payer = Keypair.generate();
    await rpc.requestAirdrop(payer.publicKey, 1e9);

    const owner = Keypair.generate();
    await rpc.requestAirdrop(owner.publicKey, 1e9);

    const mintAuthority = Keypair.generate();
    const mintKeypair = Keypair.generate();

    // 1. Create SPL mint with token pool
    const { mint } = await createMint(
        rpc,
        payer,
        mintAuthority.publicKey,
        9,
        mintKeypair,
    );

    // 2. Mint compressed tokens to owner
    await mintTo(rpc, payer, mint, owner.publicKey, mintAuthority, 1000n);

    // 3. Create destination SPL ATA (must exist before unwrap)
    const splAta = await createAssociatedTokenAccount(
        rpc,
        payer,
        mint,
        owner.publicKey,
    );

    // 4. Unwrap c-tokens to SPL ATA
    // This auto-loads compressed tokens to hot balance first
    const signature = await unwrap(
        rpc,
        payer,
        splAta,     // destination: SPL token account
        owner,      // owner of c-tokens (signer)
        mint,
        500n,       // amount to unwrap (omit for full balance)
    );

    console.log('Unwrapped 500 tokens to SPL ATA');
    console.log('Transaction:', signature);
}

main().catch(console.error);
```

```typescript Instruction
import { Keypair, ComputeBudgetProgram } from '@solana/web3.js';
import {
    createRpc,
    buildAndSignTx,
    sendAndConfirmTx,
    dedupeSigner,
} from '@lightprotocol/stateless.js';
import {
    createMint,
    mintTo,
    loadAta,
    createUnwrapInstruction,
    getAssociatedTokenAddressInterface,
    getSplInterfaceInfos,
} from '@lightprotocol/compressed-token';
import { createAssociatedTokenAccount } from '@solana/spl-token';

async function main() {
    const rpc = createRpc();
    const payer = Keypair.generate();
    await rpc.requestAirdrop(payer.publicKey, 1e9);

    const owner = Keypair.generate();
    await rpc.requestAirdrop(owner.publicKey, 1e9);

    const mintAuthority = Keypair.generate();
    const mintKeypair = Keypair.generate();

    // 1. Create SPL mint with token pool
    const { mint } = await createMint(
        rpc,
        payer,
        mintAuthority.publicKey,
        9,
        mintKeypair,
    );

    // 2. Mint compressed tokens to owner
    await mintTo(rpc, payer, mint, owner.publicKey, mintAuthority, 1000n);

    // 3. Load compressed tokens to c-token ATA (hot balance)
    const ctokenAta = getAssociatedTokenAddressInterface(mint, owner.publicKey);
    await loadAta(rpc, ctokenAta, owner, mint, payer);

    // 4. Create destination SPL ATA
    const splAta = await createAssociatedTokenAccount(
        rpc,
        payer,
        mint,
        owner.publicKey,
    );

    // 5. Get SPL interface info for the mint
    const splInterfaceInfos = await getSplInterfaceInfos(rpc, mint);
    const splInterfaceInfo = splInterfaceInfos.find(info => info.isInitialized);

    if (!splInterfaceInfo) {
        throw new Error('No SPL interface found');
    }

    // 6. Create unwrap instruction
    const ix = createUnwrapInstruction(
        ctokenAta,        // source: c-token ATA
        splAta,           // destination: SPL token account
        owner.publicKey,  // owner of source account
        mint,
        500n,             // amount to unwrap
        splInterfaceInfo, // SPL interface info
        payer.publicKey,  // fee payer
    );

    // 7. Build, sign, and send transaction
    const { blockhash } = await rpc.getLatestBlockhash();
    const additionalSigners = dedupeSigner(payer, [owner]);

    const tx = buildAndSignTx(
        [ComputeBudgetProgram.setComputeUnitLimit({ units: 200_000 }), ix],
        payer,
        blockhash,
        additionalSigners,
    );

    const signature = await sendAndConfirmTx(rpc, tx);
    console.log('Unwrapped 500 tokens to SPL ATA');
    console.log('Transaction:', signature);
}

main().catch(console.error);
```
</CodeGroup>
