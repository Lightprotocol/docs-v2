---
title: Create Associated Light Token Accounts
sidebarTitle: Create Associated Token Account
description: Client and program guide to create associated light-token accounts. Includes step-by-step implementation and full code examples.
keywords: ["associated token account on solana", "create ata for solana tokens", "rent free ata on solana", "rent free accounts on solana"]
---

---

import TokenCreateATAAccountsList from "/snippets/accounts-list/light-token-create-ata-accounts-list.mdx";
import CompressibleVsSolanaRent from "/snippets/compressible-vs-solana-rent.mdx";
import TokenConfigureRent from "/snippets/light-token-configure-rent.mdx";
import AtaIntro from "/snippets/light-token-guides/cata-intro.mdx";
import CompressibleRentExplained from "/snippets/compressible-rent-explained.mdx";
import TokenClientPrerequisites from "/snippets/light-token-guides/light-token-client-prerequisites.mdx";
import TokenTsClientPrerequisites from "/snippets/light-token-guides/light-token-ts-client-prerequisites.mdx";
import ClientCustomRentConfig from "/snippets/light-token-guides/client-custom-rent-config.mdx";
import { CodeCompare } from "/snippets/jsx/code-compare.jsx";
import FullSetup from "/snippets/setup/full-setup.mdx";
import {
  splCreateAtaCode,
  lightCreateAtaCode,
  splCreateAtaRustCode,
  lightCreateAtaRustCode,
} from "/snippets/code-samples/code-compare-snippets.jsx";
import ActionCode from "/snippets/code-snippets/light-token/create-ata/action.mdx";
import InstructionCode from "/snippets/code-snippets/light-token/create-ata/instruction.mdx";
import RustFullCode from "/snippets/code-snippets/light-token/create-ata/rust-client/full.mdx";

1. Associated light-token accounts can hold token balances of light, SPL, or Token 2022 mints.
2. The address is derived with the owner's address, compressed token program ID, and mint address.
3. Light-ATAs are on-chain accounts like SPL ATA's, but the light token program sponsors the rent-exemption cost for you.


<Accordion title="Light Rent Config Explained">
  <CompressibleRentExplained />
</Accordion>

<Tabs>

<Tab title="TypeScript Client">

The `createAtaInterface` function creates an associated light-token account in a single call.

Compare to SPL:

<CodeCompare
  firstCode={splCreateAtaCode}
  secondCode={lightCreateAtaCode}
  firstLabel="SPL"
  secondLabel="light-token"
/>

<Info>
  Find the source code
  [here](https://github.com/Lightprotocol/light-protocol/blob/0c4e2417b2df2d564721b89e18d1aad3665120e7/js/compressed-token/src/v3/actions/create-ata-interface.ts).
</Info>

<Steps>

<Step>
### Create Associated Token Account

<FullSetup />

<Tabs>
<Tab title="Action">
<ActionCode />
</Tab>
<Tab title="Instruction">
<InstructionCode />
</Tab>
</Tabs>

</Step>
</Steps>

</Tab>

<Tab title="Rust Client">

`CreateAssociatedTokenAccount` creates an on-chain ATA to store token balances of light, SPL, or Token 2022 mints.

Compare to SPL:

<CodeCompare
  firstCode={splCreateAtaRustCode}
  secondCode={lightCreateAtaRustCode}
  firstLabel="SPL"
  secondLabel="light-token"
  language="rust"
/>

<Steps>
<Step>

### Prerequisites

<TokenClientPrerequisites />

</Step>

<Step>

### Create ATA

<Info>
  Find the full example including shared test utilities in the
  [examples-light-token repo](https://github.com/Lightprotocol/examples-light-token/tree/main/rust-client/tests).
</Info>

<RustFullCode />

</Step>
</Steps>

</Tab>
<Tab title="Program Guide">

<Note>
Find [a full code example at the end](#full-code-example).
</Note>
<Steps>
<Step>

### Define Rent Config Accounts

<TokenConfigureRent />

</Step>

<Step>

### Build Account Infos and CPI the Compressed Token Program

1. Pass the required accounts that include the rent config.
2. Use `invoke` or `invoke_signed`, when a CPI requires a PDA signer.
   <Note>
     The light-ATA address is derived from `[owner, light_token_program_id, mint]`.
     Unlike light-token accounts, owner and mint are passed as accounts, not in
     instruction data.
   </Note>

<Tabs>
<Tab title="invoke (External signer)">

```rust
use light_token_sdk::token::CreateAssociatedTokenAccountCpi;

CreateAssociatedTokenAccountCpi {
    owner: owner.clone(),
    mint: mint.clone(),
    payer: payer.clone(),
    associated_token_account: associated_token_account.clone(),
    system_program: system_program.clone(),
    bump: data.bump,
    compressible: Some(compressible_params),
    idempotent: false,
}
.invoke()?;
```

</Tab>
<Tab title="invoke_signed (PDA is signer)">

```rust
use light_token_sdk::token::CreateAssociatedTokenAccountCpi;

let signer_seeds: &[&[u8]] = &[ATA_SEED, &[bump]];
CreateAssociatedTokenAccountCpi {
    owner: owner.clone(),
    mint: mint.clone(),
    payer: payer.clone(),
    associated_token_account: associated_token_account.clone(),
    system_program: system_program.clone(),
    bump: data.bump,
    compressible: Some(compressible_params),
    idempotent: false,
}
.invoke_signed(&[signer_seeds])?;
```

</Tab>
</Tabs>
<TokenCreateATAAccountsList />

</Step>
</Steps>
# Full Code Example

<Info>
  Find the source code
  [here](https://github.com/Lightprotocol/light-protocol/blob/main/sdk-tests/sdk-light-token-test/src/create_ata.rs).
</Info>

```rust expandable
use borsh::{BorshDeserialize, BorshSerialize};
use light_token_sdk::token::{CompressibleParamsCpi, CreateAssociatedTokenAccountCpi};
use solana_program::{account_info::AccountInfo, program_error::ProgramError, pubkey::Pubkey};

use crate::{ATA_SEED, ID};

/// Instruction data for create ATA V2 (owner/mint as accounts)
#[derive(BorshSerialize, BorshDeserialize, Debug)]
pub struct CreateAta2Data {
    pub bump: u8,
    pub pre_pay_num_epochs: u8,
    pub lamports_per_write: u32,
}

/// Handler for creating ATA using V2 variant (invoke)
///
/// Account order:
/// - accounts[0]: owner (readonly)
/// - accounts[1]: mint (readonly)
/// - accounts[2]: payer (signer, writable)
/// - accounts[3]: associated_token_account (writable)
/// - accounts[4]: system_program
/// - accounts[5]: compressible_config
/// - accounts[6]: rent_sponsor (writable)
pub fn process_create_ata2_invoke(
    accounts: &[AccountInfo],
    data: CreateAta2Data,
) -> Result<(), ProgramError> {
    if accounts.len() < 7 {
        return Err(ProgramError::NotEnoughAccountKeys);
    }

    let compressible_params = CompressibleParamsCpi::new(
        accounts[5].clone(),
        accounts[6].clone(),
        accounts[4].clone(),
    );

    CreateAssociatedTokenAccountCpi {
        owner: accounts[0].clone(),
        mint: accounts[1].clone(),
        payer: accounts[2].clone(),
        associated_token_account: accounts[3].clone(),
        system_program: accounts[4].clone(),
        bump: data.bump,
        compressible: Some(compressible_params),
        idempotent: false,
    }
    .invoke()?;

    Ok(())
}

/// Handler for creating ATA using V2 variant with PDA ownership (invoke_signed)
///
/// Account order:
/// - accounts[0]: owner (PDA, readonly)
/// - accounts[1]: mint (readonly)
/// - accounts[2]: payer (PDA, writable, not signer - program signs)
/// - accounts[3]: associated_token_account (writable)
/// - accounts[4]: system_program
/// - accounts[5]: compressible_config
/// - accounts[6]: rent_sponsor (writable)
pub fn process_create_ata2_invoke_signed(
    accounts: &[AccountInfo],
    data: CreateAta2Data,
) -> Result<(), ProgramError> {
    if accounts.len() < 7 {
        return Err(ProgramError::NotEnoughAccountKeys);
    }

    // Derive the PDA that will act as payer
    let (pda, bump) = Pubkey::find_program_address(&[ATA_SEED], &ID);

    // Verify the payer is the PDA
    if &pda != accounts[2].key {
        return Err(ProgramError::InvalidSeeds);
    }

    let compressible_params = CompressibleParamsCpi::new(
        accounts[5].clone(),
        accounts[6].clone(),
        accounts[4].clone(),
    );

    let signer_seeds: &[&[u8]] = &[ATA_SEED, &[bump]];
    CreateAssociatedTokenAccountCpi {
        owner: accounts[0].clone(),
        mint: accounts[1].clone(),
        payer: accounts[2].clone(), // PDA
        associated_token_account: accounts[3].clone(),
        system_program: accounts[4].clone(),
        bump: data.bump,
        compressible: Some(compressible_params),
        idempotent: false,
    }
    .invoke_signed(&[signer_seeds])?;

    Ok(())
}
```

</Tab>

</Tabs>
# Next Steps

{" "}

<Card
  title="Learn how to mint light-tokens"
  icon="chevron-right"
  color="#0066ff"
  href="/light-token/cookbook/mint-to"
  horizontal
/>
