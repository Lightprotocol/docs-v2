---
title: Transfer Interface for cToken <> SPL Token
description: Program guide for the unified transfer interface that auto-detects account types and routes cToken <> SPL token transfers.
---

import TransferInterfaceAccountsListCtoken1 from '/snippets/transfer-interface-accounts-list-ctoken-1.mdx';
import TransferInterfaceAccountsListSpl2 from '/snippets/transfer-interface-accounts-list-spl-2.mdx';

## Key Points

The `TransferInterface` is a unified API that automatically detects account types and routes to the appropriate transfer via CPI to the cToken Program:

1. **cToken → cToken**: Transfer of cTokens between cToken accounts.
2. **cToken → SPL**: Withdraw cTokens to an SPL token account
3. **SPL → cToken**: Deposit SPL tokens to a cToken account

<Info>
Learn the [core concepts to the cToken Program here](/compressed-token-program/c-token-program).
</Info>

<Note>
Find [full code examples at the end](#full-code-example).
</Note>

# Implementation Guide

<Steps>
<Step>

### cToken Transfer Interface

 
* Define the number of cTokens / SPL tokens to transfer,
* from which SPL or cToken account to transfer, and
* to which SPL or cToken account to transfer.

```rust
use light_compressed_token_sdk::ctoken::TransferInterface;

let mut transfer = TransferInterface::new(
    data.amount,
    source_account.clone(),
    destination_account.clone(),
    authority.clone(),
    payer.clone(),
    compressed_token_program_authority.clone(),
);
```
<Accordion title="cToken Interface Accounts">
<TransferInterfaceAccountsListCtoken1 />
</Accordion>

</Step>

<Step>

### SPL Interface

```rust
transfer = transfer.with_spl_interface(
    Some(mint.clone()),
    Some(spl_token_program.clone()),
    Some(token_pool_pda.clone()),
    data.token_pool_pda_bump,
)?;
```

The SPL interface requires for SPL ↔ cToken transfers the `token_pool_pda` as escrow account:
    * **SPL → cToken**: SPL tokens are transferred locked in this pool, cTokens are minted to cToken accounts
    * **cToken → SPL**: cTokens are burned, SPL tokens withdrawn to SPL token accounts

The token pool is derived from the `mint` pubkey and pool seed.

<Accordion title="SPL Interface Accounts">
<TransferInterfaceAccountsListSpl2 />
</Accordion>

</Step>

<Step>

### CPI the cToken Program

Use `invoke` or `invoke_signed`:
    * When a CPI doesn't require PDA signers, the `invoke` function is used.
    * When a CPI requires a PDA signer, the `invoke_signed` function is used.

<Tabs>
<Tab title="invoke (External Signer)">

```rust
transfer.invoke()?;
```

</Tab>
<Tab title="invoke_signed (PDA Authority)">

```rust
let authority_seeds: &[&[u8]] = &[TRANSFER_INTERFACE_AUTHORITY_SEED, &[authority_bump]];
transfer.invoke_signed(&[authority_seeds])?;
```

</Tab>
</Tabs>


</Step>
</Steps>

# Full Code Example

<Info>
Find the source code [here](https://github.com/Lightprotocol/light-protocol/blob/main/sdk-tests/sdk-ctoken-test/src/transfer_interface.rs).
</Info>

```rust expandable
use borsh::{BorshDeserialize, BorshSerialize};
use light_compressed_token_sdk::ctoken::TransferInterface;
use solana_program::{account_info::AccountInfo, program_error::ProgramError, pubkey::Pubkey};

use crate::ID;

/// PDA seed for authority in invoke_signed variants
pub const TRANSFER_INTERFACE_AUTHORITY_SEED: &[u8] = b"transfer_interface_authority";

/// Instruction data for TransferInterface
#[derive(BorshSerialize, BorshDeserialize, Debug)]
pub struct TransferInterfaceData {
    pub amount: u64,
    /// Required for SPL<->cToken transfers, None for cToken->cToken
    pub token_pool_pda_bump: Option<u8>,
}

/// Handler for TransferInterface (invoke)
///
/// This unified interface automatically detects account types and routes to:
/// - cToken -> cToken transfer
/// - cToken -> SPL transfer
/// - SPL -> cToken transfer
///
/// Account order:
/// - accounts[0]: compressed_token_program (for CPI)
/// - accounts[1]: source_account (SPL or cToken)
/// - accounts[2]: destination_account (SPL or cToken)
/// - accounts[3]: authority (signer)
/// - accounts[4]: payer (signer)
/// - accounts[5]: compressed_token_program_authority
///   For SPL interface (required for SPL<->cToken):
/// - accounts[6]: mint
/// - accounts[7]: token_pool_pda
/// - accounts[8]: spl_token_program
pub fn process_transfer_interface_invoke(
    accounts: &[AccountInfo],
    data: TransferInterfaceData,
) -> Result<(), ProgramError> {
    if accounts.len() < 6 {
        return Err(ProgramError::NotEnoughAccountKeys);
    }

    let mut transfer = TransferInterface::new(
        data.amount,
        accounts[1].clone(), // source_account
        accounts[2].clone(), // destination_account
        accounts[3].clone(), // authority
        accounts[4].clone(), // payer
        accounts[5].clone(), // compressed_token_program_authority
    );

    // Add SPL interface config if provided
    if accounts.len() >= 9 && data.token_pool_pda_bump.is_some() {
        transfer = transfer.with_spl_interface(
            Some(accounts[6].clone()), // mint
            Some(accounts[8].clone()), // spl_token_program
            Some(accounts[7].clone()), // token_pool_pda
            data.token_pool_pda_bump,
        )?;
    }

    transfer.invoke()?;

    Ok(())
}

/// Handler for TransferInterface with PDA authority (invoke_signed)
///
/// The authority is a PDA derived from TRANSFER_INTERFACE_AUTHORITY_SEED.
///
/// Account order:
/// - accounts[0]: compressed_token_program (for CPI)
/// - accounts[1]: source_account (SPL or cToken)
/// - accounts[2]: destination_account (SPL or cToken)
/// - accounts[3]: authority (PDA, not signer - program signs)
/// - accounts[4]: payer (signer)
/// - accounts[5]: compressed_token_program_authority
///   For SPL interface (required for SPL<->cToken):
/// - accounts[6]: mint
/// - accounts[7]: token_pool_pda
/// - accounts[8]: spl_token_program
pub fn process_transfer_interface_invoke_signed(
    accounts: &[AccountInfo],
    data: TransferInterfaceData,
) -> Result<(), ProgramError> {
    if accounts.len() < 6 {
        return Err(ProgramError::NotEnoughAccountKeys);
    }

    // Derive the PDA for the authority
    let (authority_pda, authority_bump) =
        Pubkey::find_program_address(&[TRANSFER_INTERFACE_AUTHORITY_SEED], &ID);

    // Verify the authority account is the PDA
    if &authority_pda != accounts[3].key {
        return Err(ProgramError::InvalidSeeds);
    }

    let mut transfer = TransferInterface::new(
        data.amount,
        accounts[1].clone(), // source_account
        accounts[2].clone(), // destination_account
        accounts[3].clone(), // authority (PDA)
        accounts[4].clone(), // payer
        accounts[5].clone(), // compressed_token_program_authority
    );

    // Add SPL interface config if provided
    if accounts.len() >= 9 && data.token_pool_pda_bump.is_some() {
        transfer = transfer.with_spl_interface(
            Some(accounts[6].clone()), // mint
            Some(accounts[8].clone()), // spl_token_program
            Some(accounts[7].clone()), // token_pool_pda
            data.token_pool_pda_bump,
        )?;
    }

    // Invoke with PDA signing
    let authority_seeds: &[&[u8]] = &[TRANSFER_INTERFACE_AUTHORITY_SEED, &[authority_bump]];
    transfer.invoke_signed(&[authority_seeds])?;

    Ok(())
}
```

# Next Steps

<Card
  title="Explore the cToken Program concepts"
  icon="chevron-right"
  color="#0066ff"
  href="/compressed-token-program/c-token-program"
  horizontal
/>